📉 Reduced batch size to 4 for GPU memory optimization
📊 Loading data...
✅ Data loaded successfully
🔍 Debugging data structure...
🔍 Debugging data loader...
Batch 0:
  Type: <class 'dict'>
  Keys: ['interaction_data', 'trait_targets', 'user_ids', 'session_ids']
    interaction_data: dict with keys ['sequence', 'timestamps']
      sequence: torch.Size([4, 20, 49])
      timestamps: torch.Size([4, 20])
    trait_targets: torch.Size([4, 20])
    user_ids: <class 'list'> - length: 4
    session_ids: <class 'list'> - length: 4
Batch 1:
  Type: <class 'dict'>
  Keys: ['interaction_data', 'trait_targets', 'user_ids', 'session_ids']
    interaction_data: dict with keys ['sequence', 'timestamps']
      sequence: torch.Size([4, 20, 49])
      timestamps: torch.Size([4, 20])
    trait_targets: torch.Size([4, 20])
    user_ids: <class 'list'> - length: 4
    session_ids: <class 'list'> - length: 4
🏗️ Creating hybrid model...
✅ Model created with 59,937,910 parameters
📊 Estimated model memory: 0.24 GB
🎯 Initializing trainer...
✅ Trainer initialized successfully
🚀 Starting training...
Starting training for 100 epochs...

Epoch 1/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:26<00:00,  7.44it/s, Loss=0.0295, Trait=0.0295]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 21.41it/s]
✅ New best model saved (val_loss: 0.029943)

Epoch 2/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.28it/s, Loss=0.0256, Trait=0.0256]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.44it/s]

Epoch 3/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.89it/s, Loss=0.0384, Trait=0.0384]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.32it/s]
✅ New best model saved (val_loss: 0.029902)

Epoch 4/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.06it/s, Loss=0.0313, Trait=0.0313]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 28.77it/s]

Epoch 5/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:26<00:00,  7.63it/s, Loss=0.0312, Trait=0.0312]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.41it/s]
✅ New best model saved (val_loss: 0.029842)

Epoch 6/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.10it/s, Loss=0.0322, Trait=0.0322]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.64it/s]

Epoch 7/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.88it/s, Loss=0.0335, Trait=0.0335]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 29.21it/s]

Epoch 8/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.78it/s, Loss=0.0358, Trait=0.0358]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 28.11it/s]

Epoch 9/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:26<00:00,  7.44it/s, Loss=0.0258, Trait=0.0258]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 29.79it/s]
✅ New best model saved (val_loss: 0.029821)

Epoch 10/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.42it/s, Loss=0.0339, Trait=0.0339]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.59it/s]
C:\Users\solos\OneDrive\Documents\College\Projects\Advanced Behavioural Analysis for Content Recommendation\Shosyn\venv\Lib\site-packages\numpy\lib\_function_base_impl.py:3063: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
C:\Users\solos\OneDrive\Documents\College\Projects\Advanced Behavioural Analysis for Content Recommendation\Shosyn\venv\Lib\site-packages\numpy\lib\_function_base_impl.py:3064: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]

Epoch 10 Summary:
├── Train Loss: 0.030448
├── Val Loss: 0.029824
├── Best Loss: 0.029821
└── Patience: 1/20
Validation Metrics:
  mean_correlation: -0.0118
  mse: 0.0298

Epoch 11/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:26<00:00,  7.69it/s, Loss=0.0237, Trait=0.0237]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:03<00:00, 15.45it/s]

Epoch 12/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:31<00:00,  6.28it/s, Loss=0.0261, Trait=0.0261]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.07it/s]

Epoch 13/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:37<00:00,  5.35it/s, Loss=0.0331, Trait=0.0331]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 17.94it/s]

Epoch 14/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:33<00:00,  6.01it/s, Loss=0.0283, Trait=0.0283]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.49it/s]

Epoch 15/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:34<00:00,  5.80it/s, Loss=0.0314, Trait=0.0314]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 19.86it/s]

Epoch 16/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:32<00:00,  6.09it/s, Loss=0.0267, Trait=0.0267]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 19.31it/s]

Epoch 17/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:32<00:00,  6.11it/s, Loss=0.0258, Trait=0.0258]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.49it/s]

Epoch 18/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:32<00:00,  6.20it/s, Loss=0.0251, Trait=0.0251]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.51it/s]

Epoch 19/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:31<00:00,  6.45it/s, Loss=0.0311, Trait=0.0311]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 19.33it/s]

Epoch 20/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:33<00:00,  5.94it/s, Loss=0.0317, Trait=0.0317]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.53it/s]

Epoch 20 Summary:
├── Train Loss: 0.030409
├── Val Loss: 0.029861
├── Best Loss: 0.029821
└── Patience: 11/20
Validation Metrics:
  mean_correlation: -0.0109
  mse: 0.0299

Epoch 21/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:33<00:00,  6.00it/s, Loss=0.0276, Trait=0.0276]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.81it/s]

Epoch 22/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:35<00:00,  5.67it/s, Loss=0.0286, Trait=0.0286]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:03<00:00, 14.98it/s]

Epoch 23/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:33<00:00,  5.93it/s, Loss=0.0296, Trait=0.0296]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 18.30it/s]
✅ New best model saved (val_loss: 0.029820)

Epoch 24/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:33<00:00,  6.02it/s, Loss=0.0286, Trait=0.0286]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 28.31it/s]

Epoch 25/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.81it/s, Loss=0.0296, Trait=0.0296]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 25.69it/s]

Epoch 26/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.70it/s, Loss=0.0347, Trait=0.0347]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 24.37it/s]

Epoch 27/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.78it/s, Loss=0.0313, Trait=0.0313]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 29.35it/s]
✅ New best model saved (val_loss: 0.029797)

Epoch 28/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.06it/s, Loss=0.0314, Trait=0.0314]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 24.99it/s]

Epoch 29/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.91it/s, Loss=0.0312, Trait=0.0312]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 28.10it/s]

Epoch 30/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.81it/s, Loss=0.0277, Trait=0.0277]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.34it/s]

Epoch 30 Summary:
├── Train Loss: 0.030387
├── Val Loss: 0.029845
├── Best Loss: 0.029797
└── Patience: 3/20
Validation Metrics:
  mean_correlation: 0.0266
  mse: 0.0298

Epoch 31/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.75it/s, Loss=0.0317, Trait=0.0317]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 28.16it/s]

Epoch 32/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.77it/s, Loss=0.0298, Trait=0.0298]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 29.34it/s]

Epoch 33/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:26<00:00,  7.66it/s, Loss=0.0266, Trait=0.0266]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.76it/s]

Epoch 34/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:25<00:00,  7.78it/s, Loss=0.0297, Trait=0.0297]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.03it/s]

Epoch 35/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:27<00:00,  7.38it/s, Loss=0.0354, Trait=0.0354]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.75it/s]

Epoch 36/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.27it/s, Loss=0.0268, Trait=0.0268]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 24.27it/s]

Epoch 37/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.40it/s, Loss=0.0311, Trait=0.0311]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.44it/s]

Epoch 38/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.37it/s, Loss=0.0308, Trait=0.0308]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 25.40it/s]

Epoch 39/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.42it/s, Loss=0.0328, Trait=0.0328]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 25.81it/s]

Epoch 40/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.10it/s, Loss=0.0342, Trait=0.0342]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.20it/s]

Epoch 40 Summary:
├── Train Loss: 0.030380
├── Val Loss: 0.029858
├── Best Loss: 0.029797
└── Patience: 13/20
Validation Metrics:
  mean_correlation: -0.0086
  mse: 0.0299

Epoch 41/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.24it/s, Loss=0.0299, Trait=0.0299]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.90it/s]

Epoch 42/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.29it/s, Loss=0.0342, Trait=0.0342]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 26.48it/s]

Epoch 43/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.17it/s, Loss=0.0280, Trait=0.0280]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 24.02it/s]

Epoch 44/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.37it/s, Loss=0.0356, Trait=0.0356]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 25.92it/s]

Epoch 45/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:24<00:00,  8.14it/s, Loss=0.0325, Trait=0.0325]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:02<00:00, 23.21it/s]

Epoch 46/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.46it/s, Loss=0.0350, Trait=0.0350]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 25.57it/s]

Epoch 47/100
Training: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:23<00:00,  8.47it/s, Loss=0.0369, Trait=0.0369]
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:01<00:00, 27.05it/s]
Early stopping at epoch 47
Training completed!
✅ Training completed successfully!
💾 Model saved as models/final_hybrid_model_cuda.pth
